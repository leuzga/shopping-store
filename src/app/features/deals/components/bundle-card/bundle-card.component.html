<div class="bundle-card group">
  <!-- Badge Bundle -->
  <div
    class="product-badge bg-purple-50 text-purple-800 border border-purple-200 px-2 py-1 text-xs font-medium rounded-none absolute top-2 left-2 z-10 flex items-center gap-1">
    <span>{{ bundle().icon }}</span>
    <span>BUNDLE</span>
  </div>

  <!-- Bundle Images Grid (Replaces single product image) -->
  <figure class="w-full h-56 bg-gray-50 grid grid-cols-2 gap-0.5 overflow-hidden cursor-pointer relative">
    @for (product of bundle().products.slice(0, 4); track product.id) {
    <div class="w-full h-full bg-white flex items-center justify-center p-2">
      <img [src]="product.image" [alt]="product.title"
        class="max-h-full max-w-full object-contain transition-transform duration-300 group-hover:scale-105" />
    </div>
    }
    <!-- Overlay count if more than 4 products -->
    @if (bundle().products.length > 4) {
    <div class="absolute bottom-1 right-1 bg-black/70 text-white text-xs px-2 py-1 rounded-sm">
      +{{ bundle().products.length - 4 }} m√°s
    </div>
    }
  </figure>

  <!-- Card Body -->
  <div class="p-4 flex flex-col h-full">
    <h2 class="font-sans font-semibold text-lg text-gray-800 truncate" [title]="bundle().name">
      {{ bundle().name }}
    </h2>

    <p class="text-sm text-gray-600 mt-1 line-clamp-2 min-h-[2.5rem]">
      {{ bundle().description }}
    </p>

    <!-- Bundle Info & Savings -->
    <div class="mt-3 flex items-center justify-between text-xs text-gray-500">
      <span class="flex items-center gap-1">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
        </svg>
        {{ bundle().products.length }} productos
      </span>
      <span class="text-green-600 font-medium">
        Ahorras {{ bundle().savings | currency }}
      </span>
    </div>

    <!-- Pricing -->
    <div class="flex flex-col mt-2 mb-3">
      <div class="text-xs text-gray-400 line-through text-right">
        {{ bundle().totalPrice | currency }}
      </div>
      <div class="flex justify-between items-end">
        <div class="badge badge-sm bg-red-100 text-red-800 border-none rounded-sm">
          -{{ bundle().discountPercentage }}%
        </div>
        <div class="font-bold text-xl text-gray-900 leading-none">
          {{ bundle().discountedPrice | currency }}
        </div>
      </div>
    </div>

    <!-- Action Button (Standard Style) -->
    <button
      class="w-full mt-auto py-2 px-4 bg-gradient-to-r from-indigo-50 to-purple-50 text-indigo-800 border border-indigo-200 rounded-none hover:bg-indigo-100 transition-all duration-200 flex items-center justify-center gap-2 font-medium"
      (click)="onViewDetails()">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
      </svg>
      {{ LABELS.BUNDLE.VIEW_DETAILS }}
    </button>
  </div>
</div>