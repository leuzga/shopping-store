<div class="page-wrapper" [class.fade-in]="isVisible()">
  <div class="page-container">
    <!-- Header -->
    <div class="page-header">
      <h1 class="text-4xl font-bold mb-2">Mis Direcciones</h1>
      <p class="text-base-content/70">Gestiona tus direcciones de envÃ­o</p>
    </div>

    <!-- Error Alert -->
    @if (error()) {
    <div class="alert alert-error mb-6">
      <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M10 14l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2m8-8l2 2m0 0l2 2m-2-2l-2-2m2 2l2-2" />
      </svg>
      <div>
        <h3 class="font-bold">Error</h3>
        <div class="text-sm">{{ error() }}</div>
      </div>
      <button class="btn btn-sm" (click)="clearError()">Cerrar</button>
    </div>
    }

    <!-- Add Address Button -->
    <div class="action-button-section">
      <button class="btn btn-primary" (click)="onAddAddress()" [disabled]="showAddForm()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
        Agregar DirecciÃ³n
      </button>
    </div>

    <!-- Address List -->
    @if (addresses().length > 0) {
    <div class="address-grid">
      @for (address of addresses(); track address.id) {
      <div class="card bg-base-100 shadow">
        <div class="card-body">
          <!-- Default Badge -->
          @if (address.isDefault) {
          <div class="badge badge-primary mb-2">DirecciÃ³n predeterminada</div>
          }

          <!-- Address Info -->
          <p class="font-semibold text-lg">{{ address.street }}</p>
          <p>{{ address.city }}, {{ address.state }} {{ address.zipcode }}</p>
          <p>{{ address.country }}</p>
          <p class="mt-2">ğŸ“ {{ address.phone }}</p>

          <!-- Actions -->
          <div class="card-actions justify-end gap-2 mt-4">
            @if (!address.isDefault) {
            <button class="btn btn-sm btn-outline" (click)="onSetDefault(address.id)">
              Predeterminada
            </button>
            }
            <button class="btn btn-sm btn-info" (click)="onEditAddress(address.id)">
              Editar
            </button>
            <button class="btn btn-sm btn-error" (click)="onDeleteAddress(address.id)">
              Eliminar
            </button>
          </div>
        </div>
      </div>
      }
    </div>
    } @else {
    <div class="alert">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-info shrink-0 w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <span>No tienes direcciones guardadas. Â¡Agrega una!</span>
    </div>
    }

    <!-- Address Form Component -->
    @if (showAddForm()) {
    <div class="mt-8">
      <app-address-form [initialData]="editingAddress()" [isLoading]="isLoading()"
        (submitted)="onAddressFormSubmit($event)" (cancelled)="onCancelForm()"></app-address-form>
    </div>
    }
  </div>
</div>